<html>

<head>
    <title>
        ממיר מספר דירה לקוד לאינטרקום
    </title>
    <style>
        body{
            direction: rtl; font-family: Arial, Helvetica, sans-serif;
        }
        .bigtext{font-size: 20px;}
        .header {
            text-align: center;
            background-color: #f1f1f1;
            padding: 20px;
        }

        .content {
            text-align: center;
            padding: 20px;
        }

        form {
            display: inline-block;
            text-align: center;
        }

        label {
            display: block;
        }

        select {
            min-width: 250px;
            margin-bottom: 10px;
        }

        button {
            margin-top: 10px;
        }

        div {
            margin-top: 10px;
        }
        .commCode{
            font-size: 18px;font-weight: bold;
        }
    </style>

</head>

<body>
    <div class="header">
        <h1>
            ממיר מספר דירה לקוד לאינטרקום
        </h1>
    </div>
    <div class="content">

        <form>
            <select id="flatNum" name="flatNum" class="bigtext" onchange="calcCode()">
                <option value="0">בחר מספר דירה</option>
            </select>
            <script>
                const flatNumSelect = document.getElementById('flatNum');
                for (let i = 1; i <= 45; i++) {
                    const option = document.createElement('option');
                    option.value = i;
                    option.text = i;
                    flatNumSelect.appendChild(option);
                }
            </script>
            <br />
            <button type="button" onclick="calcCode()" class="bigtext">
                חשב קוד
            </button>
            <br /><br />
            <div class="commCodeHide bigtext" style="display: none;">
                <span> קוד לצלצול הוא <span id="commCode" class="commCode"></span></span>
            </div>
        </form>

    </div>
    <script>
        function calcCode(num) {
            document.getElementById("commCode").innerHTML = "";
            //remove the first option from the list if it's value is 0
            if (document.getElementById("flatNum").options[0].value == 0) {
                document.getElementById("flatNum").remove(0);
            }
            
            //show the div
            document.getElementsByClassName("commCodeHide")[0].style.display = "block";
            var num = parseInt(document.getElementById("flatNum").value, 10)
           
            var commCode = convertFlatNumber(num);
            document.getElementById("commCode").innerHTML = commCode;
        }


        function convertFlatNumber(flatNum) {
            // Input validation
            if (!Number.isInteger(flatNum) || flatNum < 1 || flatNum > 45) {
                throw new Error('Invalid flat number. Must be between 1 and 45');
            }

            // Define entrances in order
            const ENTRANCES = [63, 65, 67];

            // Calculate which group of 6 we're in (each group consists of 2 flats per entrance)
            const group = Math.floor((flatNum - 1) / 6);

            // Calculate position within the group (0-5)
            const positionInGroup = (flatNum - 1) % 6;

            // Determine entrance index (0-2) and flat number within entrance
            const entranceIndex = Math.floor(positionInGroup / 2);
            const flatInEntrance = (group * 2) + (positionInGroup % 2) + 1;

            // Format the final number: entrance + two-digit flat number
            return parseInt(`${ENTRANCES[entranceIndex]}${flatInEntrance.toString().padStart(2, '0')}`);
        }
    </script>
</body>

</html>
